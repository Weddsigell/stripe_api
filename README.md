### API для интернет магазина
простой бэкенд с интеграцией stripe для интернет магазина.

2 api endpoints:
* GET /buy/{id} - c помощью которого можно получить Stripe Session Id для оплаты выбранного Item
* GET /item/{id} - c помощью которого можно получить простейшую HTML страницу, на которой будет информация о выбранном Item и кнопка Buy

### Демо
Проект развернут и доступен по адресу [http://185.170.153.77]("http://185.170.153.77")

## Как установить
Склонируйте данный репозиторий к себе
```bash
git clone https://github.com/Weddsigell/stripe_api.git
cd stripe_api
```

## Переменные окружения
Часть настроек проекта берётся из переменных окружения. Чтобы их определить, создайте файл .env рядом со скриптами и запишите туда данные в таком формате: ПЕРЕМЕННАЯ=значение.

Доступны 3 переменныx:
* DJANGO_SECRET_KEY - секретный ключ Django, используемый для шифрования сессий, CSRF-токенов и других криптографических операций. Должен быть длинным, случайным и храниться в безопасности.
Для локального запуска вы можете сгенерировать новый ключ с помощью встроенной утилиты Django:
```bash
python - << 'EOF'
from django.core.management.utils import get_random_secret_key
print(get_random_secret_key())
EOF

```
* DJANGO_DEBUG — режим отладки Django (True или False). Включает подробные сообщения об ошибках и автообновление кода. На продакшене должен быть False. По умолчанию False
* DJANGO_ALLOWED_HOSTS — список доменов и IP-адресов, на которых разрешено работать приложению Django. Например: ["example.com", "www.example.com"]. По умолчанию ["localhost", "127.0.0.1"]
* STRIPE_PUBLISHABLE_KEY - Зарегистрируйтесь [тут](https://dashboard.stripe.com/test/dashboard), переключитесь в test mode, На главной панели будет ключ начинается с pk_test_
* STRIPE_SECRET_KEY - Зарегистрируйтесь [тут](https://dashboard.stripe.com/test/dashboard), переключитесь в test mode, На главной панели будет ключ начинается с sk_test_

## Как запустить
Для запуска сайта вам понадобится UV. Как установить вы найдете [тут](https://github.com/astral-sh/uv).

Применить миграции
```bash
uv run manage.py migrate
```
Создать суперпользователя
```bash
uv run manage.py createsuperuser
```
Запустить сервер разработки
```bash
uv run manage.py runserver
```

## Заполнение базы данных
После запуска сервера:
1. Перейдите на /admin вашего сайта (например, http://127.0.0.1:8000/admin)
2. Войдите с помощью созданного суперпользователя
3. Добавляйте данные через интерфейс администратора

## Зависимости
* Python>=3.12.6
* django>=6.0.1
* environs>=14.5.0
* gunicorn>=23.0.0
* stripe>=14.1.0
* whitenoise>=6.11.0

## Структура проекта
```
stripe_api/
│── manage.py # основной скрипт
│── stripe_api # директория django проекта
│── api # директория django приложения
│── pyproject.toml # uv файл
│── uv.lock # uv файл
│── .python-version # uv файл
│── Dockerfile # файл для работы с docker
└── README.md # документация
```

###### Спасибо за просмотр